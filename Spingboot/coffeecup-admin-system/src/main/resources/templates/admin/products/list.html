<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Manage Products - CoffeeCup Admin</title>
    <link rel="stylesheet" th:href="@{/css/admin-style.css}">
    <style>
        .product-thumbnail {
            max-width: 60px;
            height: auto;
            max-height: 60px;
            object-fit: cover;
            border: 1px solid #eee;
            vertical-align: middle;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Manage Products</h1>

    <!-- Hiển thị thông báo thành công/lỗi từ RedirectAttributes -->
    <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show" role="alert">
        [[${successMessage}]]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show" role="alert">
        [[${errorMessage}]]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <div class="action-bar">
        <a th:href="@{/}" class="btn btn-secondary">Back to Home</a>
        <a th:href="@{/admin/products/add}" class="btn btn-primary">Add New Product</a>
    </div>

    <table class="table">
        <thead>
        <tr>
            <th>ID</th>
            <th>Image</th>
            <th>Name</th>
            <th>Description</th>
            <th>Price</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="product : ${products}">
            <td th:text="${product.ma}">1</td>
            <td>
                <img th:if="${product.imageFileName != null}"
                     th:src="@{${product.getImageUrl()}}"
                     alt="Product Image" class="product-thumbnail"/>
                <span th:unless="${product.imageFileName != null}">No Image</span>
            </td>
            <td th:text="${product.ten}">Sample Product</td>
            <td th:text="${#strings.abbreviate(product.moTa, 80)}">Short desc...</td>
            <td th:text="${#numbers.formatCurrency(product.gia)}">$10.00</td>
            <td>
                <a th:href="@{/admin/products/edit/{id}(id=${product.ma})}" class="btn btn-sm btn-warning">Edit</a>
                <a th:href="@{/admin/products/delete/{id}(id=${product.ma})}"
                   class="btn btn-sm btn-danger"
                   onclick="return confirm('Are you sure you want to delete this product?');">Delete</a>
            </td>
        </tr>
        <tr th:if="${#lists.isEmpty(products)}">
            <td colspan="6" style="text-align: center;">No products found.</td>
        </tr>
        </tbody>
    </table>
</div>
<!-- Optional: Thêm link Bootstrap JS cuối body nếu muốn nút close hoạt động -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> -->
</body>
</html>